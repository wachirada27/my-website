<!doctype html>
<html lang="th">
<head>
<meta charset="UTF-8" />
<title>CPE x Drive Safety – Settings</title>

<link rel="icon" href="../img/icon.png" />
<link rel="stylesheet" href="../CSS/style.css" />
<link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet"/>

<style>
.save-btn{
  margin-top:20px;
  padding:10px 20px;
  border:none;
  border-radius:10px;
  background:#1b5e4b;
  color:white;
  cursor:pointer;
  font-weight:bold;
}

.status-msg{
  margin-top:15px;
  font-weight:bold;
  color:#2e7d32;
}
</style>
</head>

<body>
<div class="app">

<header>
  <div class="logo">
    <img src="../img/icon.png" alt="Logo" />
    <span>CPE x Drive Safety</span>
  </div>
</header>

<aside>
  <a href="index.html">Dashboard</a>
  <a href="map.html">GPS Tracking</a>
  <a href="drivers.html">Drivers</a>
  <a href="reports.html">Reports</a>
  <a href="settings.html">Settings</a>
</aside>

<main>
<div class="hero">
  <h1>ตั้งค่าระบบ</h1>
</div>

<section class="panel">
<h2>การตั้งค่าทั่วไป</h2>

<table>
<tr>
  <th>รายการ</th>
  <th>ค่าปัจจุบัน</th>
  <th>การตั้งค่า</th>
</tr>

<tr>
  <td>เวลาขับสูงสุดต่อรอบ</td>
  <td id="maxTimeDisplay">4 ชั่วโมง</td>
  <td>
    <select id="maxTime">
      <option value="3">3 ชั่วโมง</option>
      <option value="4" selected>4 ชั่วโมง</option>
      <option value="5">5 ชั่วโมง</option>
    </select>
  </td>
</tr>

<tr>
  <td>การแจ้งเตือน</td>
  <td id="alertStatus">เปิดใช้งาน</td>
  <td>
    <select id="alertToggle">
      <option value="on" selected>เปิด</option>
      <option value="off">ปิด</option>
    </select>
  </td>
</tr>

<tr>
  <td>รูปแบบการแจ้งเตือน</td>
  <td id="alertTypeDisplay">เสียง + หน้าจอ</td>
  <td>
    <select id="alertType">
      <option value="screen">เฉพาะหน้าจอ</option>
      <option value="both" selected>เสียง + หน้าจอ</option>
      <option value="sound">เฉพาะเสียง</option>
    </select>
  </td>
</tr>
</table>

<button class="save-btn" onclick="saveSettings()">บันทึกการตั้งค่า</button>
<div class="status-msg" id="saveMsg"></div>

</section>

<section class="panel" style="margin-top:30px;">
<h2>บัญชีผู้ดูแลระบบ</h2>
<table>
<tr>
  <th>ชื่อ</th>
  <th>อีเมล</th>
  <th>สถานะ</th>
</tr>
<tr>
  <td>Admin</td>
  <td>admin@cpe-drive.com</td>
  <td class="ok">Online</td>
</tr>
</table>
</section>

</main>
</div>

<script>

// โหลดค่าที่เคยบันทึก
window.onload = function(){
  const saved = JSON.parse(localStorage.getItem("settings"));
  if(saved){
    document.getElementById("maxTime").value = saved.maxTime;
    document.getElementById("alertToggle").value = saved.alertToggle;
    document.getElementById("alertType").value = saved.alertType;
    updateDisplay();
  }
};

// อัปเดตค่าที่แสดง
function updateDisplay(){
  const maxTime = document.getElementById("maxTime").value;
  const alertToggle = document.getElementById("alertToggle").value;
  const alertType = document.getElementById("alertType").value;

  document.getElementById("maxTimeDisplay").innerText = maxTime + " ชั่วโมง";
  document.getElementById("alertStatus").innerText = 
      alertToggle === "on" ? "เปิดใช้งาน" : "ปิดใช้งาน";

  let typeText = "";
  if(alertType === "screen") typeText = "เฉพาะหน้าจอ";
  if(alertType === "sound") typeText = "เฉพาะเสียง";
  if(alertType === "both") typeText = "เสียง + หน้าจอ";

  document.getElementById("alertTypeDisplay").innerText = typeText;
}

// บันทึกค่า
function saveSettings(){

  updateDisplay();

  const settings = {
    maxTime: document.getElementById("maxTime").value,
    alertToggle: document.getElementById("alertToggle").value,
    alertType: document.getElementById("alertType").value
  };

  localStorage.setItem("settings", JSON.stringify(settings));

  const msg = document.getElementById("saveMsg");
  msg.innerText = "บันทึกการตั้งค่าเรียบร้อยแล้ว";
  setTimeout(()=> msg.innerText = "", 3000);
}

</script>

</body>
</html>